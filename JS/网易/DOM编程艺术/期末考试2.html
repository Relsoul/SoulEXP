<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
	</head>
	<body>
		<select name="year" id="year">
        <option value="0">--</option>
        <option value="1999">1999</option>
        <option value="2000">2000</option>
        <option value="2001">2001</option>
    </select>年
    <select name="month" id="month">
        <option value="0">--</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
    </select>月
    <select name="date" id="date">
        <option value="0">--</option>
    </select>日
    <script type="text/javascript">
    	function Obj(dateElem,monthElem,yearElem){
    		function $(id){return document.getElementById(id);}
    		this.dateElem=$(dateElem);
    		this.monthElem=$(monthElem);
    		this.yearElem=$(yearElem);
    	}
    	Obj.prototype.checkPass=function(elem){
    		if(elem.value=="0"){
    			if(this.yearElem.value=="0"){
    				return false;
    			}
    			return false;
    		}else{
    			return true;
    		}	
    	}
    	Obj.prototype.checkYear=function(value){
    		if((value%4==0 && value%100!=0)||(value%100==0 && value%400==0)){
    			return true;
    		}else{
    			return false;
    		}
    	}
    	Obj.prototype.deleteDate=function(elem){
    			for(var i=elem.length-1;i>0;i--){
    				elem.remove(i)
    			}
    	}
    	Obj.prototype.sumDate=function(data){
    		var bigM=[1,3,5,7,8,10,12];
    		if(data=="2"&&this.checkYear(this.yearElem.value)==true){
    			return 29;
    		}else if(data=="2"&&this.checkYear(this.yearElem.value)==false){
    			return 28;
    		}
    		for(var i=0;i<bigM.length;i++){
    			if(bigM[i]==data){
    				return 31;
    			}
    		}
    		return 30;
    	}
    	Obj.prototype.addElem=function(data){
    		function add(elem,num){
    			for(var i=1;i<=num;i++){
      				  var option=new Option(i,i)
    				elem.add(option)
    				elem.options[0].selected=true;
    			}
    		}
    		switch(data){
    			case "month":add(this.monthElem,12);break;
    			case "date":add(this.dateElem,this.sumDate(this.monthElem.value));break;
    		}
    	}
    	Obj.prototype.addYearEv=function(){
    		var y=this.yearElem;
    		var that=this;
    		that.deleteDate(that.monthElem)
    		y.addEventListener("change",function(){
    			that.deleteDate(that.dateElem)
    			that.deleteDate(that.monthElem)
				that.addElem("month")
    		})
    	}
    	Obj.prototype.addMonthEv=function(){
    		var m=this.monthElem;
    		var that=this;
    		var d=that.dateElem;
    		m.addEventListener("change",function(){
    			if(that.checkPass(that.yearElem)==false||that.checkPass(that.monthElem)==false){
    				that.deleteDate(that.dateElem);
    				return false;
    			}
    			that.deleteDate(that.dateElem)
    			that.addElem("date")
    		})
    	}
    	
    	Obj.prototype.addDateEv=function(){
    		var d=this.dateElem;
    		var that=this;
    		d.addEventListener("change",function(){
    			if(that.checkPass(that.yearElem)==false||that.checkPass(that.monthElem)==false){
    				that.deleteDate(that.dateElem);
    				return false
    			}
    		})
    	}
    	var soul=new Obj("date","month","year");
    	soul.addYearEv()
    	soul.addMonthEv()
    	soul.addDateEv()
    </script>
	</body>
</html>
